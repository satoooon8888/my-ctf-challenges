from pwn import *
from base64 import b64encode, b64decode
from Crypto.Util.number import *

io = remote("27.133.155.191", 30013)

N = int(io.recvline().rstrip()[len("(N, e) = ("):-len(", 65537)")])
e = 65537

log.info(f"N = {N}")

encrypted_flag_b64 = io.recvline().rstrip()[len("encryption FLAG is ")-1:]
print(encrypted_flag_b64)
encrypted_flag = bytes_to_long(b64decode(encrypted_flag_b64))

log.info(f"{encrypted_flag}")

r = 2
cr = encrypted_flag * pow(r, e, N) % N

io.recv()
io.sendline(b64encode(long_to_bytes(cr)))
io.recvuntil(b"Your plaintext is ")

mr_b64 = io.recvline().rstrip()
mr =  bytes_to_long(b64decode(mr_b64))
m = mr * inverse(r, N) % N
log.info(f"FLAG: {long_to_bytes(m)}")
